
section_ordering:
  - "Identity and Access Management"
  - "Security Center"
  - "Storage Accounts"
  - "SQL Servers"
  - "Logging and Monitoring"
  - "Networking"
  - "Virtual Machines"
  - "Other Security Considerations"

subsection_ordering:
  - "Profile Applicability"
  - "Description"
  - "Rationale"
  - "Audit"
  - "Remediation"
  - "Impact"
  - "Default Value"
  - "References"
  - "Notes"
  - "CIS Controls"

audit_subsction_ordering:
  - "Azure Console"
  - "Azure Powershell"
  - "Azure Command Line Interface 2.0"

# We have stripped the "Ensure that" prefix from all names, removed '?' and "'"
# That leaves some subsection_name's upper and some lower case.
TOC:
  "Identity and Access Management":
      - subsection_number: 1.1 
        subsection_name: 'multi-factor authentication is enabled for all privileged users'
        finding_name: ''
      - subsection_number: 1.2 
        subsection_name: 'multi-factor authentication is enabled for all non-privileged users'
        finding_name: ''
      - subsection_number: 1.3 
        subsection_name: 'there are no guest users'
        finding_name: ''
      - subsection_number: 1.4 
        subsection_name: 'Allow users to remember multi-factor authentication on devices they trust is Disabled'
        finding_name: ''
      - subsection_number: 1.5 
        subsection_name: 'Number of methods required to reset is set to 2'
        finding_name: ''
      - subsection_number: 1.6 
        subsection_name: 'Number of days before users are asked to re-confirm their authentication information is not set to 0'
        finding_name: ''
      - subsection_number: 1.7 
        subsection_name: 'Notify users on password resets is set to Yes'
        finding_name: ''
      - subsection_number: 1.8 
        subsection_name: 'Notify all admins when other admins reset their password is set to Yes'
        finding_name: ''
      - subsection_number: 1.9 
        subsection_name: 'Users can consent to apps accessing company data on their behalf is set to No'
        finding_name: ''
      - subsection_number: 1.10 
        subsection_name: 'Users can add gallery apps to their Access Panel is set to No'
        finding_name: ''
      - subsection_number: 1.11 
        subsection_name: 'Users can register applications is set to No'
        finding_name: ''
      - subsection_number: 1.12 
        subsection_name: 'Guest users permissions are limited is set to Yes'
        finding_name: ''
      - subsection_number: 1.13 
        subsection_name: 'Members can invite is set to No'
        finding_name: ''
      - subsection_number: 1.14 
        subsection_name: 'Guests can invite is set to No'
        finding_name: ''
      - subsection_number: 1.15 
        subsection_name: 'Restrict access to Azure AD administration portal is set to Yes'
        finding_name: ''
      - subsection_number: 1.16 
        subsection_name: 'Self-service group management enabled is set to No'
        finding_name: ''
      - subsection_number: 1.17 
        subsection_name: 'Users can create security groups is set to No'
        finding_name: ''
      - subsection_number: 1.18 
        subsection_name: 'Users who can manage security groups is set to None'
        finding_name: ''
      - subsection_number: 1.19 
        subsection_name: 'Users can create Office 365 groups is set to No'
        finding_name: ''
      - subsection_number: 1.20 
        subsection_name: 'Users who can manage Office 365 groups is set to None'
        finding_name: ''
      - subsection_number: 1.21 
        subsection_name: 'Enable "All Users" group is set to Yes'
        finding_name: ''
      - subsection_number: 1.22 
        subsection_name: 'Require Multi-Factor Auth to join devices is set to Yes'
        finding_name: ''
      - subsection_number: 1.23 
        subsection_name: 'no custom subscription owner roles are created'
        finding_name: ''
  "Security Center":
    - subsection_number: 2.1 
      subsection_name: 'standard pricing tier is selected'
      finding_name: ''
    - subsection_number: 2.2 
      subsection_name: 'Automatic provisioning of monitoring agent is set to On'
      finding_name: 'automatic_provisioning_of_monitoring_agent_is_set_to_on'
    - subsection_number: 2.3 
      subsection_name: 'System updates is set to On'
      finding_name: 'system_updates_is_set_to_on'
    - subsection_number: 2.4 
      subsection_name: 'Security Configurations is set to On'
      finding_name: 'security_configurations_is_set_to_on'
    - subsection_number: 2.5 
      subsection_name: 'Endpoint protection is set to On'
      finding_name: 'endpoint_protection_is_set_to_on'
    - subsection_number: 2.6 
      subsection_name: 'Disk encryption is set to On'
      finding_name: 'disk_encryption_is_set_to_on'
    - subsection_number: 2.7 
      subsection_name: 'Network security groups is set to On'
      finding_name: 'network_security_groups_is_set_to_on'
    - subsection_number: 2.8 
      subsection_name: 'Web application firewall is set to On'
      finding_name: 'web_application_firewall_is_set_to_on'
    - subsection_number: 2.9 
      subsection_name: 'Next generation firewall is set to On'
      finding_name: 'next_generation_firewall_is_set_to_on'
    - subsection_number: 2.10
      subsection_name: 'Vulnerability assessment is set to On'
      finding_name: 'vulnerability_assessment_is_set_to_on'
    - subsection_number: 2.11
      subsection_name: 'Storage Encryption is set to On'
      finding_name: 'storage_encryption_is_set_to_on'
    - subsection_number: 2.12
      subsection_name: 'JIT Network Access is set to On'
      finding_name: 'just_in_time_access_is_set_to_on'
    - subsection_number: 2.13
      subsection_name: 'Adaptive Application Controls is set to On'
      finding_name: 'adaptive_application_controls_is_set_to_on'
    - subsection_number: 2.14
      subsection_name: 'SQL auditing & Threat detection is set to On'
      finding_name: 'sql_auditing_and_threat_detection_is_set_to_on'
    - subsection_number: 2.15
      subsection_name: 'SQL Encryption is set to On'
      finding_name: 'sql_encryption_is_set_to_on'
    - subsection_number: 2.16
      subsection_name: 'Security contact emails is set'
      finding_name: 'security_contact_emails_is_set'
    - subsection_number: 2.17
      subsection_name: 'security contact Phone number is set'
      finding_name: 'security_contact_phone_number_is_set'
    - subsection_number: 2.18
      subsection_name: 'Send me emails about alerts is set to On'
      finding_name: 'send_me_emails_about_alerts_is_set_to_on'
    - subsection_number: 2.19
      subsection_name: 'Send email also to subscription owners is set to On'
      finding_name: 'send_email_also_to_subscription_owners_is_set_to_on'
  "Storage Accounts":
    - subsection_number: 3.1
      subsection_name: 'Secure transfer required is set to Enabled'
      finding_name: 'secure_transfer_required_is_set_to_enabled'
    - subsection_number: 3.2
      subsection_name: 'Storage service encryption is set to Enabled for Blob Service'
      finding_name: 'storage_service_encryption_is_set_to_enabled_for_blob_service'
    - subsection_number: 3.3
      subsection_name: 'storage account access keys are periodically regenerated'
      finding_name: 'storage_account_access_keys_are_periodically_regenerated'
    - subsection_number: 3.4
      subsection_name: 'shared access signature tokens expire within an hour'
      finding_name: 'shared_access_signature_tokens_expire_within_an_hour'
    - subsection_number: 3.5
      subsection_name: 'shared access signature tokens are allowed only over https'
      finding_name: 'shared_access_signature_tokens_are_allowed_only_over_https'
    - subsection_number: 3.6
      subsection_name: 'Public access level is set to private for blob containers'
      finding_name: 'public_access_level_is_set_to_private_for_blob_containers'
    - subsection_number: 3.7
      subsection_name: 'Storage network default access rule set to deny'
      finding_name: 'storage_network_default_access_rule_set_to_deny'
  "SQL Servers":
    - subsection_number: 4.1.1
      subsection_name: 'Auditing is set to On'
      finding_name: 'auditing_is_set_to_on'
    - subsection_number: 4.1.2
      subsection_name: 'Threat Detection is set to On'
      finding_name: ''
    - subsection_number: 4.1.3
      subsection_name: 'Threat Detection types is set to All'
      finding_name: ''
    - subsection_number: 4.1.4
      subsection_name: 'Send alerts to is set'
      finding_name: ''
    - subsection_number: 4.1.5
      subsection_name: 'Email service and co-administrators is Enabled'
      finding_name: 'email_service_and_co_administrators_is_enabled'
    - subsection_number: 4.1.6
      subsection_name: 'Auditing Retention is greater than 90 days'
      finding_name: ''
    - subsection_number: 4.1.7
      subsection_name: 'Threat Detection Retention is greater than 90 days'
      finding_name: ''
    - subsection_number: 4.1.8
      subsection_name: 'Azure Active Directory Admin is configured'
      finding_name: ''
  # "SQL Databases":
  #   - subsection_number: 4.2.1 
  #     subsection_name: 'Auditing is set to On'
  #     finding_name: ''
  #   - subsection_number: 4.2.2 
  #     subsection_name: 'Threat Detection is set to On'
  #     finding_name: ''
  #   - subsection_number: 4.2.3 
  #     subsection_name: 'Threat Detection types is set to All'
  #     finding_name: ''
  #   - subsection_number: 4.2.4 
  #     subsection_name: 'Send alerts to is set'
  #     finding_name: ''
  #   - subsection_number: 4.2.5 
  #     subsection_name: 'Email service and co-administrators is Enabled'
  #     finding_name: 'email_service_and_co_administrators_is_enabled'
  #   - subsection_number: 4.2.6 
  #     subsection_name: 'Data encryption is set to On'
  #     finding_name: ''
  #   - subsection_number: 4.2.7 
  #     subsection_name: 'Auditing Retention is greater than 90 days'
  #     finding_name: ''
  #   - subsection_number: 4.2.8 
  #     subsection_name: 'Threat Retention is greater than 90 days'
  #     finding_name: ''
  "Logging and Monitoring":
    - subsection_number: 5.1
      subsection_name: 'a Log Profile exists'
      finding_name: ''
    - subsection_number: 5.2
      subsection_name: 'Activity Log Retention is set 365 days or greater'
      finding_name: ''
    # - subsection_number: 5.3
    #   subsection_name: 'Activity Log Alert exists for Create Policy Assignment'
    #   finding_name: 'activity_log_alert_exists_for_create_policy_assignment'
    - subsection_number: 5.3
      subsection_name: 'Activity Log Alert is Configured'
      finding_name: 'activity_log_alert_is_configured'
    - subsection_number: 5.4
      subsection_name: 'Activity Log Alert exists for Create or Update Network Security Group'
      finding_name: ''
    - subsection_number: 5.5
      subsection_name: 'Activity Log Alert exists for Delete Network Security Group'
      finding_name: ''
    - subsection_number: 5.6
      subsection_name: 'Activity Log Alert exists for Create or Update Network Security Group Rule'
      finding_name: ''
    - subsection_number: 5.7
      subsection_name: 'Activity Log Alert exists for Delete Network Security Group Rule'
      finding_name: ''
    - subsection_number: 5.8
      subsection_name: 'Activity Log Alert exists for Create or Update Security Solution'
      finding_name: ''
    - subsection_number: 5.9
      subsection_name: 'Activity Log Alert exists for Delete Security Solution'
      finding_name: ''
    - subsection_number: 5.10
      subsection_name: 'Activity Log Alert exists for Create or Update SQL Server Firewall Rule'
      finding_name: ''
    - subsection_number: 5.11
      subsection_name: 'Activity Log Alert exists for Delete SQL Server Firewall Rule'
      finding_name: ''
    - subsection_number: 5.12
      subsection_name: 'Activity Log Alert exists for Update Security Policy'
      finding_name: ''
      subsection_number: 5.13
      subsection_name: 'logging for Azure KeyVault is Enabled'
      finding_name: ''
  "Networking":
    # - subsection_number: 6.1
    #   subsection_name: 'RDP access is restricted from the internet'
    #   finding_name: ''
    - subsection_number: 6.1
      subsection_name: 'Access is restricted from the internet'
      finding_name: 'access_is_restricted_from_the_internet'
    - subsection_number: 6.2
      subsection_name: 'SSH access is restricted from the internet'
      finding_name: ''
    - subsection_number: 6.3
      subsection_name: 'SQL server access is restricted from the internet'
      finding_name: ''
    - subsection_number: 6.4
      subsection_name: 'Network Security Group Flow Log retention period is greater than 90 days'
      finding_name: ''
    - subsection_number: 6.5
      subsection_name: 'Network Watcher is Enabled'
      finding_name: ''
  "Virtual Machines":
    - subsection_number: 7.1
      subsection_name: 'VM agent is installed'
      finding_name: ''
    - subsection_number: 7.2
      subsection_name: 'OS disk is encrypted'
      finding_name: ''
    - subsection_number: 7.3
      subsection_name: 'Data disks are encrypted'
      finding_name: ''
    - subsection_number: 7.4
      subsection_name: 'only approved extensions are installed'
      finding_name: ''
    - subsection_number: 7.5
      subsection_name: 'the latest OS Patches for all Virtual Machines are applied'
      finding_name: ''
    - subsection_number: 7.6
      subsection_name: 'Endpoint protection for all Virtual Machines is installed'
      finding_name: 'endpoint_protection_for_all_virtual_machines_is_installed'
  "Other Security Considerations":
    # - subsection_number: 8.1
    #   subsection_name: 'the expiry date is set on all Keys'
    #   finding_name: ''
    - subsection_number: 8.1
      subsection_name: 'the expiry date is set on all Keys and Secrets'
      finding_name: 'expiry_date_is_set_on_all_keys_and_secrets'
    - subsection_number: 8.2
      subsection_name: 'the expiry date is set on all Secrets'
      finding_name: ''
    - subsection_number: 8.3
      subsection_name: 'Resource Locks are set for mission critical Azure resources'
      finding_name: ''
