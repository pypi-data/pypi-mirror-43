parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"ycQc":[function(require,module,exports) {

},{}],"PzSq":[function(require,module,exports) {
var e=window.Messages,t={},n={},i={},o=null,a={};function r(t){t.error&&e.enqueue({text:_.isString(t.error)?t.error:gettext("An error occurred."),tags:"error"}),t.success&&e.enqueue({text:_.isString(t.success)?t.success:gettext("Success."),tags:"success"})}function c(n,i,o){var a=_.extend({},{command:n},i||{}),c=m.request(_.extend({method:"POST",url:t.apiUrl,data:a,config:function(e){e.setRequestHeader("X-CSRFToken",window.ShuupAdminConfig.csrf)}},o));return c.then(function(e){r(e)},function(){e.enqueue({text:gettext("An unspecified error occurred."),tags:"error"})}),c}function s(){var e=this;e.steps=m.prop([]),e.currentItem=m.prop(null),e.newStepItemModalInfo=m.prop(null),c("getData").then(function(t){e.steps(t.steps)}),e.removeStepItem=function(t,n,i){var o=n+"s";t[o]=_.reject(t[o],function(e){return e===i}),e.currentItem()===i&&e.activateStepItem(null,null,null)},e.addStepItem=function(t,n,i,o){var a={identifier:i};t[n+"s"].push(a),o&&e.activateStepItem(t,n,a)},e.setStepItemEditorState=function(e){e?document.getElementById("step-item-wrapper").style.display="block":(document.getElementById("step-item-wrapper").style.display="none",document.getElementById("step-item-frame").src="about:blank")},e.activateStepItem=function(n,i,o){if(n&&o){e.currentItem(o);var a=_.extend(document.createElement("form"),{target:"step-item-frame",method:"POST",action:t.itemEditorUrl});a.appendChild(_.extend(document.createElement("input"),{name:"init_data",type:"hidden",value:JSON.stringify({eventIdentifier:t.eventIdentifier,itemType:i,data:o})})),document.body.appendChild(a),a.submit(),e.setStepItemEditorState(!0)}else e.currentItem(null),e.setStepItemEditorState(!1)},e.receiveItemEditData=function(t){var n=e.currentItem();n?(m.startComputation(),e.currentItem(_.extend(n,t)),m.endComputation()):alert(gettext("Unexpected edit data received."))},e.saveState=function(){c("saveData",{steps:e.steps()})},e.deleteStep=function(t){e.steps(_.reject(e.steps(),function(e){return e===t}))},e.addNewStep=function(){var t=e.steps();t.push({actions:[],conditions:[],enabled:!0,next:"continue",condOp:"and"}),e.steps(t)},e.moveStep=function(t,n){var i=e.steps(),o=_.indexOf(i,t);if(-1===o)return!1;var a=o+n;i.splice(a,0,i.splice(o,1)[0]),e.steps(i)},e.promptForNewStepItem=function(t,n){e.newStepItemModalInfo({step:t,itemType:n,title:gettext("Add new")+" "+n})},e.closeNewStepItemModal=function(){e.newStepItemModalInfo(null)},e.createNewStepItemFromModal=function(t){var n=e.newStepItemModalInfo();e.closeNewStepItemModal(),null!==n&&e.addStepItem(n.step,n.itemType,t,!0)}}function d(e,t,i){var o=i+"s",a=n[i],r=t[o],c=m("ul.action-list",r.map(function(n){var o=a[n.identifier]||n.identifier,r="li",c=e.currentItem()===n;return c&&(r+=".current"),m(r,[m("a",{href:"#",onclick:c?null:_.partial(e.activateStepItem,t,i,n)},o)," ",m("a.delete",{href:"#",onclick:function(){confirm(gettext("Delete this item?\nThis can not be undone."))&&e.removeStepItem(t,i,n)}},m("i.fa.fa-trash"))])}));return m("div",[c,m("div.action-new",[m("a.btn.btn-xs.btn-primary",{href:"#",onclick:_.partial(e.promptForNewStepItem,t,i)},m("i.fa.fa-plus")," "+gettext("New")+" "+i)])])}function p(e){return _.map(e.steps(),function(t,n){var i=m("select",{value:t.cond_op,onchange:m.withAttr("value",function(e){t.cond_op=e})},a.condOps),o=m("select",{value:t.next,onchange:m.withAttr("value",function(e){t.next=e})},a.stepNexts);return m("div",{className:"step"+(t.enabled?"":" disabled"),key:t.id},[m("div.step-buttons",[n>0?m("a",{href:"#",title:gettext("Move Up"),onclick:_.partial(e.moveStep,t,-1)},m("i.fa.fa-caret-up")):null,n<e.steps().length-1?m("a",{href:"#",title:gettext("Move Down"),onclick:_.partial(e.moveStep,t,1)},m("i.fa.fa-caret-down")):null,t.enabled?m("a",{href:"#",title:gettext("Disable"),onclick:function(){t.enabled=!1}},m("i.fa.fa-ban")):m("a",{href:"#",title:gettext("Enable"),onclick:function(){t.enabled=!0}},m("i.fa.fa-check-circle")),m("a",{href:"#",title:gettext("Delete"),onclick:function(){confirm(gettext("Are you sure you wish to delete this step?"))&&e.deleteStep(t)}},m("i.fa.fa-trash"))]),m("div.step-conds",[m("span.hint",gettext("If"),i,gettext("of these conditions hold...")),d(e,t,"condition")]),m("div.step-actions",[m("span.hint",gettext("then execute these actions...")),d(e,t,"action")]),m("div.step-next",[m("span.hint",gettext("and then...")),o])])})}function u(e,t){return m("div.new-step-item-modal-overlay",{onclick:e.closeNewStepItemModal},[m("div.new-step-item-modal",[m("div.title",t.title),m("div.item-options",_.map(_.sortBy(_.values(i[t.itemType]),"name"),function(t){return m("div.item-option",{onclick:_.partial(e.createNewStepItemFromModal,t.identifier)},[m("div.item-name",t.name),t.description?m("div.item-description",t.description):null])}))])])}function l(e){var t,n=null;return null!==(t=e.newStepItemModalInfo())&&(n=u(e,t)),m("div.step-list-wrapper",[m("div.steps",[p(e),m("hr.script-separator"),m("a.new-step-link.btn.btn-info.btn-sm",{href:"#",onclick:e.addNewStep},m("i.fa.fa-plus")," "+gettext("New step"))]),n])}function f(e){return _.sortBy(_.map(e,function(e,t){return m("option",{value:t},e)}),function(e){return e.children[0].toLowerCase()})}function v(e){return _(e).map(function(e,t){return[t,e.name]}).zipObject().value()}function I(e){t=_.extend({},e),i.condition=t.conditionInfos,i.action=t.actionInfos,n.condition=v(i.condition),n.action=v(i.action),a.condOps=f(t.condOps),a.stepNexts=f(t.stepNexts),o=m.mount(document.getElementById("step-table-container"),{controller:s,view:l}),window.addEventListener("message",function(e){e.data.new_data&&o.receiveItemEditData(e.data.new_data)},!1)}function S(){o.saveState()}window.ScriptEditor={init:I,save:S,hideEditModal:function(){o&&(m.startComputation(),o.setStepItemEditorState(!1),o.activateStepItem(null),m.endComputation())}};
},{}],"Focm":[function(require,module,exports) {
"use strict";require("./script-editor.less"),require("./script-editor.js");
},{"./script-editor.less":"ycQc","./script-editor.js":"PzSq"}]},{},["Focm"], null)
//# sourceMappingURL=/script-editor.map