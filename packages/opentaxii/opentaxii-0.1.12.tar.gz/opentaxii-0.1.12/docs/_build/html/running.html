
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Running OpenTAXII &#8212; OpenTAXII 0.1.11 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Docker" href="docker.html" />
    <link rel="prev" title="Configuration" href="configuration.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="running-opentaxii">
<h1>Running OpenTAXII<a class="headerlink" href="#running-opentaxii" title="Permalink to this headline">¶</a></h1>
<p>Here we describe how to run OpenTAXII in a <em>development</em> or <em>production</em> mode. Development mode activates <a class="reference external" href="http://flask.pocoo.org/">Flask</a> debug mode, simplifies log messages (for humans) and runs the server in one thread. While in production mode there are no debug messages, proper json log messages and multithreaded if configured.</p>
<div class="section" id="development-mode">
<h2>Development mode<a class="headerlink" href="#development-mode" title="Permalink to this headline">¶</a></h2>
<p>To run the server in development mode use the CLI command shipped with OpenTAXII package:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>venv<span class="o">)</span> $ opentaxii-run-dev
</pre></div>
</div>
<p>This will start OpenTAXII in a development mode and bind it to <code class="docutils literal notranslate"><span class="pre">localhost:9000</span></code>.</p>
</div>
<div class="section" id="production-mode">
<h2>Production mode<a class="headerlink" href="#production-mode" title="Permalink to this headline">¶</a></h2>
<p>To run OpenTAXII in production it is recommended to use <a class="reference external" href="http://flask.pocoo.org/docs/1.0/tutorial/deploy/#run-with-a-production-server">standalone WSGI
container</a>
that works with Flask. In this example we use <a class="reference external" href="http://gunicorn.org/">Gunicorn WSGI HTTP Server</a>. For complete logging configuration we recommend
Gunicorn 19.8 and above.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Run <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">gunicorn</span></code> to install gunicorn. Yes, it’s that simple.</p>
</div>
<p>To run OpenTAXII with Gunicorn execute:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>venv<span class="o">)</span> $ gunicorn opentaxii.http:app <span class="se">\</span>
  --bind localhost:9000 --config python:opentaxii.http
</pre></div>
</div>
<p>Common practice is to wrap gunicorn execution into <a class="reference external" href="http://supervisord.org">supervisord</a>, to be able to monitor, start, and stop it easily.</p>
<p>Example supervisord configuration file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[program:opentaxii]</span>

<span class="na">command</span> <span class="o">=</span><span class="s"></span>
<span class="s">    /opt/eclecticiq/opentaxii-venv/bin/gunicorn opentaxii.http:app</span>
<span class="s">        --workers 2</span>
<span class="s">        --log-level info</span>
<span class="s">        --log-file -</span>
<span class="s">        --timeout 300</span>
<span class="s">        --bind localhost:9000</span>
<span class="s">        --config python:opentaxii.http</span>
<span class="na">environment</span> <span class="o">=</span><span class="s"></span>
<span class="s">    OPENTAXII_CONFIG=&quot;/opt/eclecticiq/custom-opentaxii-configuration.yml&quot;</span>

<span class="na">stdout_logfile</span> <span class="o">=</span> <span class="s">/var/log/opentaxii.log</span>
<span class="na">redirect_stderr</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">autostart</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">autorestart</span> <span class="o">=</span> <span class="s">true</span>
</pre></div>
</div>
</div>
<div class="section" id="using-ssl-tls">
<h2>Using SSL/TLS<a class="headerlink" href="#using-ssl-tls" title="Permalink to this headline">¶</a></h2>
<p>If you want to run OpenTAXII with SSL, you need to use a web server like <a class="reference external" href="https://nginx.org/en/">Nginx</a>, that provides SSL/TLS layer. You can find details on how to run Nginx with SSL <a class="reference external" href="https://nginx.org/en/docs/http/configuring_https_servers.html">here</a>.</p>
<p>Make sure you configure your TAXII services in OpenTAXII with proper protocol bindings:</p>
<blockquote>
<div><ul class="simple">
<li>use <code class="docutils literal notranslate"><span class="pre">urn:taxii.mitre.org:protocol:https:1.0</span></code> if you’re planning on serving data via HTTPS.</li>
<li>use <code class="docutils literal notranslate"><span class="pre">urn:taxii.mitre.org:protocol:http:1.0</span></code> if the server is going to support unsecure HTTP as well.</li>
</ul>
</div></blockquote>
<p>You can use multiple protocol bindings per service. That would tell OpenTAXII you want to advertise services over both HTTPs and HTTP. TAXII services create external URLs according to their protocol bindings, using <code class="docutils literal notranslate"><span class="pre">http://</span></code> or <code class="docutils literal notranslate"><span class="pre">https://</span></code> schemas.</p>
</div>
<div class="section" id="sending-requests-to-services">
<h2>Sending requests to services<a class="headerlink" href="#sending-requests-to-services" title="Permalink to this headline">¶</a></h2>
<p>The easiest way to send requests to TAXII services is to use <a class="reference external" href="http://github.com/eclecticiq/cabby">Cabby library</a> CLI tools:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>venv<span class="o">)</span> $ pip install cabby
</pre></div>
</div>
<p>If you are running OpenTAXII in default configuration and you created services using <a class="reference internal" href="configuration.html"><span class="doc">provided examples</span></a>, you should
be able to communicate with the services.</p>
<p>Assuming OpenTAXII is running on <code class="docutils literal notranslate"><span class="pre">http://localhost:9000</span></code>, to get the list of advertised services, run:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>venv<span class="o">)</span> $ taxii-discovery --path http://localhost:9000/services/discovery-a
</pre></div>
</div>
<p>You should see the following output:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="m">2018</span>-06-03 <span class="m">21</span>:26:32,188 INFO: Sending Discovery_Request to http://localhost:9000/services/discovery-a
<span class="m">2018</span>-06-03 <span class="m">21</span>:26:32,207 INFO: <span class="m">7</span> services <span class="nv">discovered</span>
<span class="o">===</span> Service <span class="nv">Instance</span> <span class="o">===</span>
  Service Type: INBOX
  Service Version: urn:taxii.mitre.org:services:1.1
  Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
  Service Address: http://localhost:9000/services/inbox-a
  Message Binding: urn:taxii.mitre.org:message:xml:1.0
  Message Binding: urn:taxii.mitre.org:message:xml:1.1
  Inbox Service AC: <span class="o">[]</span>
  Available: True
  Message: Custom Inbox Service Description <span class="nv">A</span>

<span class="o">===</span> Service <span class="nv">Instance</span> <span class="o">===</span>
  Service Type: INBOX
  Service Version: urn:taxii.mitre.org:services:1.1
  Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
  Service Address: http://localhost:9000/services/inbox-b
  Message Binding: urn:taxii.mitre.org:message:xml:1.0
  Message Binding: urn:taxii.mitre.org:message:xml:1.1
  Inbox Service AC: <span class="o">[</span><span class="s1">&#39;urn:stix.mitre.org:xml:1.1.1&#39;</span>, <span class="s1">&#39;urn:custom.example.com:json:0.0.1&#39;</span><span class="o">]</span>
  Available: True
  Message: Custom Inbox Service Description <span class="nv">B</span>

<span class="o">===</span> Service <span class="nv">Instance</span> <span class="o">===</span>
  Service Type: DISCOVERY
  Service Version: urn:taxii.mitre.org:services:1.1
  Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
  Service Address: http://localhost:9000/services/discovery-a
  Message Binding: urn:taxii.mitre.org:message:xml:1.0
  Message Binding: urn:taxii.mitre.org:message:xml:1.1
  Available: True
  Message: Custom Discovery Service description

..... snip .....
</pre></div>
</div>
<p>One of the configured services is a Collection Management Service. To get the collections list, run:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>venv<span class="o">)</span> $ taxii-collections --path http://localhost:9000/services/collection-management-a
</pre></div>
</div>
<p>You should see the following output:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="m">2018</span>-06-03 <span class="m">21</span>:30:03,315 INFO: Sending Collection_Information_Request to http://localhost:9000/services/collection-management-a
<span class="o">===</span> Data Collection <span class="nv">Information</span> <span class="o">===</span>
  Collection Name: collection-a
  Collection Type: DATA_SET
  Available: True
  Collection Description: None
  Supported Content: <span class="nv">All</span>
  <span class="o">===</span> Polling Service <span class="nv">Instance</span> <span class="o">===</span>
    Poll Protocol: urn:taxii.mitre.org:protocol:http:1.0
    Poll Address: http://localhost:9000/services/poll-a
    Message Binding: urn:taxii.mitre.org:message:xml:1.0
    Message Binding: urn:taxii.mitre.org:message:xml:1.1
  <span class="o">===</span> Subscription <span class="nv">Service</span> <span class="o">===</span>
    Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
    Address: http://localhost:9000/services/collection-management-a
    Message Binding: urn:taxii.mitre.org:message:xml:1.0
    Message Binding: urn:taxii.mitre.org:message:xml:1.1
  <span class="o">===</span> Subscription <span class="nv">Service</span> <span class="o">===</span>
    Protocol Binding: urn:taxii.mitre.org:protocol:https:1.0
    Address: https://localhost:9000/services/collection-management-a
    Message Binding: urn:taxii.mitre.org:message:xml:1.0
    Message Binding: urn:taxii.mitre.org:message:xml:1.1
  <span class="o">===</span> Receiving Inbox <span class="nv">Service</span> <span class="o">===</span>
    Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
    Address: http://localhost:9000/services/inbox-a
    Message Binding: urn:taxii.mitre.org:message:xml:1.0
    Message Binding: urn:taxii.mitre.org:message:xml:1.1
    Supported Contents: <span class="nv">All</span>
<span class="o">==================================</span>


<span class="o">===</span> Data Collection <span class="nv">Information</span> <span class="o">===</span>
  Collection Name: collection-b
  Collection Type: DATA_FEED
  Available: True
  Collection Description: None
  Supported Content:   urn:stix.mitre.org:xml:1.1.1
  <span class="o">===</span> Polling Service <span class="nv">Instance</span> <span class="o">===</span>
    Poll Protocol: urn:taxii.mitre.org:protocol:http:1.0
    Poll Address: http://localhost:9000/services/poll-a
    Message Binding: urn:taxii.mitre.org:message:xml:1.0
    Message Binding: urn:taxii.mitre.org:message:xml:1.1
  <span class="o">===</span> Subscription <span class="nv">Service</span> <span class="o">===</span>
    Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
    Address: http://localhost:9000/services/collection-management-a
    Message Binding: urn:taxii.mitre.org:message:xml:1.0
    Message Binding: urn:taxii.mitre.org:message:xml:1.1
  <span class="o">===</span> Subscription <span class="nv">Service</span> <span class="o">===</span>
    Protocol Binding: urn:taxii.mitre.org:protocol:https:1.0
    Address: https://localhost:9000/services/collection-management-a
    Message Binding: urn:taxii.mitre.org:message:xml:1.0
    Message Binding: urn:taxii.mitre.org:message:xml:1.1
  <span class="o">===</span> Receiving Inbox <span class="nv">Service</span> <span class="o">===</span>
    Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
    Address: http://localhost:9000/services/inbox-a
    Message Binding: urn:taxii.mitre.org:message:xml:1.0
    Message Binding: urn:taxii.mitre.org:message:xml:1.1
    Supported Contents: <span class="nv">All</span>
  <span class="o">===</span> Receiving Inbox <span class="nv">Service</span> <span class="o">===</span>
    Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
    Address: http://localhost:9000/services/inbox-b
    Message Binding: urn:taxii.mitre.org:message:xml:1.0
    Message Binding: urn:taxii.mitre.org:message:xml:1.1
    Supported Content: urn:stix.mitre.org:xml:1.1.1
    Supported Content: urn:custom.example.com:json:0.0.1
<span class="o">==================================</span>

.... snip .....
</pre></div>
</div>
<p>See <a class="reference external" href="http://cabby.readthedocs.org">Cabby documentation</a> for more examples.</p>
</div>
<div class="section" id="health-check">
<h2>Health check<a class="headerlink" href="#health-check" title="Permalink to this headline">¶</a></h2>
<p>OpenTAXII has an endpoint that can be used to check health of the service:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ curl http://localhost:9000/management/health
<span class="o">{</span>
  <span class="s2">&quot;alive&quot;</span>: <span class="nb">true</span>
<span class="o">}</span>
</pre></div>
</div>
<p class="rubric">Next steps</p>
<p>Continue to <a class="reference internal" href="auth.html"><span class="doc">Authentication</span></a> page to learn how OpenTAXII authentication process works.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Running OpenTAXII</a><ul>
<li><a class="reference internal" href="#development-mode">Development mode</a></li>
<li><a class="reference internal" href="#production-mode">Production mode</a></li>
<li><a class="reference internal" href="#using-ssl-tls">Using SSL/TLS</a></li>
<li><a class="reference internal" href="#sending-requests-to-services">Sending requests to services</a></li>
<li><a class="reference internal" href="#health-check">Health check</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="configuration.html" title="previous chapter">Configuration</a></li>
      <li>Next: <a href="docker.html" title="next chapter">Docker</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016-2019, EclecticIQ.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>